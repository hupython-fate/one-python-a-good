'''

Requestsåº“ä¸­çš„`sessions`æ¨¡å—æ˜¯æˆ‘ä»¬å¤„ç†HTTPè¯·æ±‚æ—¶çš„ä¸€ä¸ªå¼ºå¤§å·¥å…·ï¼Œå°¤å…¶é€‚åˆå¤„ç†éœ€è¦ä¿æŒç‰¹å®šçŠ¶æ€æˆ–è¿›è¡Œå¤šæ¬¡è¯·æ±‚çš„åœºæ™¯ã€‚ä¸‹é¢æˆ‘ä»¬è¯¦ç»†è§£æå®ƒã€‚

### ç†è§£ Session çš„æ ¸å¿ƒä½œç”¨

æƒ³è±¡ä¸€ä¸‹ï¼ŒSessionå°±åƒä¸€ä¸ªè™šæ‹Ÿçš„æµè§ˆå™¨æ ‡ç­¾é¡µã€‚å½“ä½ åœ¨è¿™ä¸ªæ ‡ç­¾é¡µä¸­ç™»å½•ç½‘ç«™åï¼Œåç»­çš„æ“ä½œï¼ˆå¦‚è®¿é—®ä¸ªäººä¸»é¡µï¼‰é€šå¸¸ä¼šä¿æŒç™»å½•çŠ¶æ€ã€‚
RequestsSessionçš„ä½œç”¨ç±»ä¼¼ï¼š ** åœ¨å¤šæ¬¡è¯·æ±‚é—´ä¿æŒæŸäº›å‚æ•°å’ŒçŠ¶æ€ **ã€‚

å®ƒçš„ä¸¤ä¸ªä¸»è¦ä¼˜åŠ¿æ˜¯ï¼š

1. ** è¿æ¥å¤ç”¨ **ï¼šSession
å¯¹è±¡å†…éƒ¨ä½¿ç”¨äº† ** è¿æ¥æ±  **ã€‚å½“å‘åŒä¸€ä¸»æœºå‘é€å¤šä¸ªè¯·æ±‚æ—¶ï¼Œåº•å±‚çš„TCPè¿æ¥ä¼šè¢«å¤ç”¨ï¼Œé¿å…äº†é¢‘ç¹å»ºç«‹å’Œæ–­å¼€è¿æ¥çš„å¼€é”€ï¼Œä»è€Œæ˜¾è‘—æå‡æ€§èƒ½ã€‚
2. ** çŠ¶æ€ä¿æŒ **ï¼šSession
å¯ä»¥è·¨è¯·æ±‚è‡ªåŠ¨ä¿æŒcookiesç­‰ä¿¡æ¯ã€‚è¿™åœ¨å¤„ç†éœ€è¦ç™»å½•çš„ç½‘ç«™æ—¶éå¸¸æ–¹ä¾¿ã€‚

### ğŸ› ï¸ Session å¯¹è±¡çš„åˆ›å»ºä¸é…ç½®

ä½¿ç”¨
Session
çš„ç¬¬ä¸€æ­¥æ˜¯åˆ›å»ºå®ƒï¼š
'''

import requests

# åˆ›å»º Session å¯¹è±¡
session = requests.Session()#requests.Sessionsæ˜¯ç±»åï¼Œ

'''
ä½ å¯ä»¥ä¸ºSessioné¢„è®¾ä¸€äº› ** é»˜è®¤å‚æ•° **ï¼Œè¿™äº›å‚æ•°ä¼šåº”ç”¨äºè¯¥Sessionå‘å‡ºçš„æ‰€æœ‰è¯·æ±‚ï¼š

'''
# è®¾ç½®é»˜è®¤è¯·æ±‚å¤´
session.headers.update({'User-Agent': 'my-app/0.0.1'})

# è®¾ç½®è®¤è¯ä¿¡æ¯
session.auth = ('user', 'pass')

# è®¾ç½®ä»£ç†
session.proxies = {
    'http': 'http://proxy.example.com:8080',
    'https': 'https://proxy.example.com:8080'
}

'''

æˆ‘ä»¬é€šå¸¸è¯´çš„ä»£ç†ï¼Œæ˜¯æŒ‡ç½‘ç»œä»£ç†ï¼Œå³å®¢æˆ·ç«¯ä¸ç›´æ¥è¿æ¥ç›®æ ‡æœåŠ¡å™¨ï¼Œè€Œæ˜¯é€šè¿‡ä¸€ä¸ªä¸­é—´æœåŠ¡å™¨ï¼ˆä»£ç†æœåŠ¡å™¨ï¼‰æ¥è½¬å‘è¯·æ±‚å’Œå“åº”ã€‚åœ¨requestsä¸­è®¾ç½®ä»£ç†ï¼Œå°±æ˜¯å‘Šè¯‰requestsåº“å°†è¯·æ±‚å‘é€åˆ°ä»£ç†æœåŠ¡å™¨ï¼Œç”±ä»£ç†æœåŠ¡å™¨å»è·å–ç›®æ ‡æœåŠ¡å™¨çš„å“åº”ï¼Œç„¶åä»£ç†æœåŠ¡å™¨å†å°†å“åº”è¿”å›ç»™å®¢æˆ·ç«¯ã€‚

ä½¿ç”¨ä»£ç†çš„ä¸»è¦ç›®çš„åŒ…æ‹¬ï¼š

éšè—å®¢æˆ·ç«¯çš„çœŸå®IPåœ°å€ï¼Œä¿æŠ¤éšç§ã€‚

ç»•è¿‡ç½‘ç»œé™åˆ¶ï¼ˆå¦‚é˜²ç«å¢™ã€IPå°é”ç­‰ï¼‰ã€‚

è®¿é—®åœ¨ç‰¹å®šåœ°åŒºå—é™çš„å†…å®¹ï¼ˆåœ°ç†å°é”ï¼‰ã€‚

è¿›è¡Œç½‘ç»œè°ƒè¯•å’Œç›‘æ§ã€‚

åœ¨requestsä¸­ï¼Œå¯ä»¥é€šè¿‡ç»™è¯·æ±‚ä¼ é€’proxieså‚æ•°æ¥è®¾ç½®ä»£ç†ã€‚proxieså‚æ•°æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œé”®æ˜¯åè®®ï¼ˆå¦‚'http', 'https'ï¼‰ï¼Œå€¼æ˜¯ä»£ç†æœåŠ¡å™¨çš„åœ°å€ã€‚

ä¾‹å¦‚ï¼š
proxies = {
'http': 'http://10.10.1.10:3128',
'https': 'http://10.10.1.10:1080',

** ä½¿ç”¨æ–¹æ³•çº§å‚æ•° ** æ—¶ï¼Œéœ€è¦æ³¨æ„æ–¹æ³•å±‚çš„å‚æ•°ä¼šè¦†ç›–ä¼šè¯å±‚çš„åŒåå‚æ•°ã€‚
å¦‚æœæƒ³åœ¨æŸä¸ªè¯·æ±‚ä¸­ ** ç§»é™¤ ** ä¼šè¯å±‚è®¾ç½®çš„æŸä¸ªå¤´ï¼Œ
åªéœ€åœ¨è¯¥è¯·æ±‚çš„æ–¹æ³•å±‚å‚æ•°ä¸­å°†è¯¥å€¼è®¾ä¸º
`None`ã€‚
'''



```python
# è¿™ä¸ªè¯·æ±‚ä¼šå‘é€ 'User-Agent': 'my-app/0.0.1'
response1 = session.get('https://httpbin.org/headers')

# è¿™ä¸ªè¯·æ±‚ä¼šå‘é€ 'User-Agent': 'other-agent'ï¼Œå› ä¸ºæ–¹æ³•å±‚å‚æ•°è¦†ç›–äº†ä¼šè¯å±‚å‚æ•°
response2 = session.get('https://httpbin.org/headers', headers={'User-Agent': 'other-agent'})

# è¿™ä¸ªè¯·æ±‚ä¸ä¼šå‘é€ 'x-test' å¤´ï¼Œå› ä¸ºå®ƒåœ¨æ–¹æ³•å±‚è¢«è®¾ç½®ä¸º None
response3 = session.get('https://httpbin.org/headers', headers={'x-test': None})
```
'''
### ğŸ” ä½¿ç”¨ Session å¤„ç† Cookies ä¸ç™»å½•

Session
èƒ½ ** è‡ªåŠ¨å¤„ç†
Cookies **ã€‚æœåŠ¡å™¨é€šè¿‡
Set - Cookie
å¤´è®¾ç½®çš„
cookies
ä¼šè¢«
Session
ä¿å­˜ï¼Œå¹¶åœ¨åç»­è¯·æ±‚ä¸­è‡ªåŠ¨å‘é€ã€‚

ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨
Session
ä¿æŒç™»å½•çŠ¶æ€ï¼š


'''
```python
import requests

# åˆ›å»º Session
with requests.Session() as session:
    # é…ç½®è¯·æ±‚å¤´
    session.headers.update({
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"
    })

    # é¦–å…ˆï¼Œè®¿é—®ç™»å½•é¡µé¢è·å–ä»¤ç‰Œï¼ˆå¦‚ authenticity_tokenï¼‰
    login_page_url = 'https://github.com/login'
    login_page_response = session.get(login_page_url)
    # æ­¤å¤„åº”è§£æç™»å½•é¡µé¢è·å–å¿…è¦çš„ä»¤ç‰Œï¼Œä¾‹å¦‚ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼
    # authenticity_token = ... (è§£æé€»è¾‘)

    # å‡†å¤‡ç™»å½•æ•°æ®
    login_data = {
        'login': 'your_username',
        'password': 'your_password',
        # 'authenticity_token': authenticity_token  # éœ€è¦ä»ç™»å½•é¡µé¢è§£æ
    }

    # æäº¤ç™»å½•è¯·æ±‚
    login_url = 'https://github.com/session'
    login_response = session.post(login_url, data=login_data)

    # ç™»å½•æˆåŠŸåï¼Œä½¿ç”¨åŒä¸€ä¸ª Session è®¿é—®éœ€è¦ç™»å½•çš„é¡µé¢
    profile_url = 'https://github.com/your_username'
    profile_response = session.get(profile_url)

    # æ£€æŸ¥ç™»å½•æ˜¯å¦æˆåŠŸï¼Œä¾‹å¦‚æ£€æŸ¥å“åº”å†…å®¹æˆ–çŠ¶æ€ç 
    print(profile_response.status_code)
    # è¿›ä¸€æ­¥å¤„ç†å“åº”å†…å®¹...
```

'''

### ğŸ“‹ Session å¯¹è±¡çš„ä¸»è¦æ–¹æ³•

Session
å¯¹è±¡æä¾›äº†ä¸
requests
æ¨¡å—é¡¶å±‚çº§å‡½æ•°ç±»ä¼¼çš„
HTTP
æ–¹æ³•ï¼Œå¦‚
`get()`, `post()`, `put()`, `delete()`, `head()`, `options()`, `patch()`ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–æœ‰ç”¨çš„æ–¹æ³•ï¼š

| æ–¹æ³• | ä¸»è¦ä½œç”¨ | å¸¸ç”¨åœºæ™¯ / è¯´æ˜ |
|:--- |: --- |:--- |
| `request()` | å‘é€è¯·æ±‚çš„æ ¸å¿ƒæ–¹æ³• | å…¶ä»–ä¾¿æ·æ–¹æ³•ï¼ˆå¦‚
`get`, `post`ï¼‰å†…éƒ¨è°ƒç”¨å®ƒ |
| `get()`, `post()`
ç­‰ | å‘é€ç‰¹å®šç±»å‹HTTPè¯·æ±‚ | ä¸
`requests.get()`
ç­‰å‚æ•°ç›¸åŒï¼Œä½†ä¿æŒä¼šè¯çŠ¶æ€ |
| `close()` | å…³é—­ä¼šè¯ï¼Œé‡Šæ”¾è¿æ¥èµ„æº | å¯¹äºé•¿æ—¶é—´è¿è¡Œçš„ç¨‹åºï¼Œå»ºè®®æ˜¾å¼å…³é—­ |
| `prepare_request()` | é¢„å¤„ç†Requestå¯¹è±¡ï¼Œè¿”å›PreparedRequest | ç”¨äºåœ¨å‘é€å‰ä¿®æ”¹è¯·æ±‚ä½“æˆ–å¤´ |

### ğŸ”§ è¿›é˜¶ç”¨æ³•ä¸åº•å±‚æ“ä½œ

1. ** ä½¿ç”¨é¢„å¤‡è¯·æ±‚(PreparedRequest) **

è¿™æ˜¯
Requests
åº“ä¸­ä¸€ä¸ªæ›´åº•å±‚çš„ç±»ï¼ŒåŒ…å«äº†å°†è¦å‘é€åˆ°æœåŠ¡å™¨çš„å‡†ç¡®æ•°æ®ã€‚é€šå¸¸ä»ä¸€ä¸ª
Request
å¯¹è±¡ç”Ÿæˆ
PreparedRequestã€‚ä½¿ç”¨
`Session.prepare_request()`
å¯ä»¥è·å–ä¸€ä¸ªå¸¦æœ‰å½“å‰
Session
çŠ¶æ€ï¼ˆå¦‚
cookiesï¼‰çš„
PreparedRequestã€‚

'''

```python
from requests import Request, Session

session = Session()
req = Request('GET', 'https://httpbin.org/get', headers={'x-test': 'true'})

prepped = session.prepare_request(req)

# åœ¨å‘é€å‰ï¼Œå¯ä»¥ä¿®æ”¹é¢„å¤‡è¯·æ±‚çš„å±æ€§
# prepped.headers['x-test'] = 'modified'

resp = session.send(prepped)
print(resp.status_code)
```

'''

2. ** ç¡®ä¿èµ„æºé‡Šæ”¾ **

ä½¿ç”¨
Session
åï¼Œæœ€å¥½æ˜¾å¼å…³é—­å®ƒä»¥é‡Šæ”¾èµ„æºã€‚æ¨èä½¿ç”¨
`
with` è¯­å¥ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œè¿™æ ·å³ä½¿å‘ç”Ÿå¼‚å¸¸ï¼ŒSession ä¹Ÿä¼šè¢«æ­£ç¡®å…³é—­ã€‚


'''
# æ¨èä½¿ç”¨ with è¯­å¥
with requests.Session() as session:
    session.get('https://httpbin.org/get')
# é€€å‡º with å—åï¼Œsession ä¼šè‡ªåŠ¨å…³é—­
''''
### âš ï¸ æ³¨æ„äº‹é¡¹

- ** æ–¹æ³•å±‚å‚æ•°ä¸è·¨è¯·æ±‚ä¿æŒ **ï¼šåœ¨å•ä¸ªè¯·æ±‚æ–¹æ³•ï¼ˆå¦‚
`get()`ï¼‰ä¸­è®¾ç½®çš„å‚æ•°ï¼ˆå¦‚
`cookies`ï¼‰åªå¯¹è¯¥æ¬¡è¯·æ±‚æœ‰æ•ˆï¼Œä¸ä¼šä¿å­˜åœ¨
Session
ä¸­å¹¶å¸¦åˆ°ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚ä¾‹å¦‚ï¼Œç¬¬ä¸€ä¸ªè¯·æ±‚å•ç‹¬è®¾ç½®äº†
`cookies`
å‚æ•°ï¼Œä¸‹ä¸€ä¸ªè¯·æ±‚é»˜è®¤ä¸ä¼šæºå¸¦è¿™ä¸ª
cookieã€‚
- ** é€‚é…å™¨é…ç½® **ï¼šSession
ä½¿ç”¨é€‚é…å™¨å¤„ç†ä¸åŒåè®®çš„è¿æ¥ç»†èŠ‚ã€‚ä½ å¯ä»¥é€šè¿‡
`get_adapter()`
æ–¹æ³•è·å–é€‚é…å™¨ï¼Œæˆ–ä½¿ç”¨
`mount()`
æ–¹æ³•ä¸ºç‰¹å®š
URL
å‰ç¼€æŒ‚è½½è‡ªå®šä¹‰é€‚é…å™¨ã€‚

### ç®€å•æ€»ç»“

`requests.Session`
æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå®ƒé€šè¿‡ ** è¿æ¥å¤ç”¨ ** å’Œ ** çŠ¶æ€ä¿æŒ ** æœºåˆ¶ï¼Œæå¤§åœ°ç®€åŒ–äº†éœ€è¦å¤„ç†å¤šæ¬¡è¯·æ±‚ã€å°¤å…¶æ˜¯éœ€è¦ç»´æŒä¼šè¯çŠ¶æ€ï¼ˆå¦‚ç™»å½•ï¼‰çš„ç¼–ç¨‹ä»»åŠ¡ã€‚
åœ¨ç¼–å†™éœ€è¦ä¸åŒä¸€ä¸»æœºè¿›è¡Œå¤šæ¬¡äº¤äº’çš„ç¨‹åºæ—¶ï¼Œä½¿ç”¨Sessioné€šå¸¸æ˜¯æ›´é«˜æ•ˆå’Œæ›´ä¸“ä¸šçš„é€‰æ‹©ã€‚

å¸Œæœ›ä»¥ä¸Šè§£æèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨`sessions`æ¨¡å—ã€‚å¦‚æœä½ å¯¹ç‰¹å®šæ–¹æ³•æˆ–åœºæ™¯æœ‰æ›´å¤šç–‘é—®ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚

'''


import requests.sessions as RS

K=dir(RS)
for j in K:
    print(j)




    '''
    requests åº“çš„ sessions æ¨¡å—æ˜¯å…¶æ ¸å¿ƒï¼Œä¸»è¦æä¾›äº†ä¸€ä¸ªé‡è¦çš„ Session ç±»ï¼Œç”¨äºåœ¨å¤šä¸ªHTTPè¯·æ±‚é—´ä¿æŒå‚æ•°å’Œè¿æ¥ã€‚
    ä¸‹é¢æ˜¯è¯¥æ¨¡å—çš„è¯¦ç»†ä¿¡æ¯æ±‡æ€»ï¼ŒåŠ©ä½ å¿«é€Ÿäº†è§£å…¶ç»“æ„ã€‚

æ¨¡å—ç»„ä»¶	åç§°	                               ä¸»è¦åŠŸèƒ½/ç”¨é€”
ç±»	    Session	                           æä¾›ä¼šè¯ä¸Šä¸‹æ–‡ï¼Œè·¨è¯·æ±‚ä¿æŒå‚æ•°ï¼ˆå¦‚cookiesã€headersï¼‰ã€è¿æ¥æ± ç®¡ç†ã€‚
æ–¹æ³•	    request(method, url, **kwargs)	   æ ¸å¿ƒæ–¹æ³•ï¼Œæ„å»ºå¹¶å‘é€è¯·æ±‚ï¼Œå…¶ä»–ä¾¿æ·æ–¹æ³•ï¼ˆå¦‚get, postï¼‰éƒ½è°ƒç”¨å®ƒã€‚
        get(url, **kwargs)	               å‘é€GETè¯·æ±‚ã€‚
        post(url, **kwargs)	               å‘é€POSTè¯·æ±‚ã€‚
        put(url, **kwargs)	               å‘é€PUTè¯·æ±‚ã€‚
        delete(url, **kwargs)	           å‘é€DELETEè¯·æ±‚ã€‚
        head(url, **kwargs)	               å‘é€HEADè¯·æ±‚ã€‚
        patch(url, **kwargs)	           å‘é€PATCHè¯·æ±‚ã€‚
        options(url, **kwargs)	           å‘é€OPTIONSè¯·æ±‚ã€‚
        prepare_request(request)	       é¢„å¤„ç†Requestå¯¹è±¡ï¼Œè¿”å›PreparedRequestã€‚
        send(request, **kwargs)	           å‘é€PreparedRequestå¯¹è±¡ã€‚
        close()	                           å…³é—­ä¼šè¯ï¼Œé‡Šæ”¾è¿æ¥æ± ç­‰èµ„æºã€‚
å‡½æ•°	    session()	                       è¿”å›ä¸€ä¸ªæ–°çš„Sessionå¯¹è±¡ã€‚
    
    '''